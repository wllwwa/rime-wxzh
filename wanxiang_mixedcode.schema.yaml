# Rime schema settings
# encoding: utf-8
###############选择与之匹配的拼音方案#####################
set_shuru_schema:
  __include: 自然码    #可选的选项有（全拼, 自然码, 小鹤双拼, 微软双拼, 搜狗双拼, 智能ABC, 紫光双拼, 拼音加加，国标双拼, 自然龙， 汉心龙）
super_comment:                 # 超级注释模块，子项配置 true 开启，false 关闭
  candidate_length: 1          # 候选词辅助码提醒的生效长度，0为关闭  但同时清空其它，应当使用上面开关来处理
  corrector_type: "{comment}"  # 换一种显示类型，比如"({comment})" 
######################################################
schema:
  schema_id: wanxiang_mixedcode
  name: "万象：混合编码"
  version: "LTS"
  author: amzxyz
  description: |
    混合编码负责将英文、中英文混合、携带符号的词组等全部统一到这个方案中完成
  dependencies:
    - wanxiang_reverse    # 部件拆字，反查及辅码

    

switches:
  - name: ascii_punct                  # 中英标点
    states: [ 中标, 英标 ]
  - name: full_shape                   #全角、半角字符输出
    states: [ 半角, 全角 ]
  - name: super_tips                   #开启后在输入编码后面的提示区显示实时的提示数据，受tips数据库影响，表情、翻译、车牌、符号等对应关系数据，并可实现句号上屏，不开启则默认，影响的是segment.prompt参数，归属：super_tips.lua
    states: [ 提示关, 提示开 ]
    reset: 1
engine:
  processors:
    - lua_processor@*super_tips            #超级提示模块：表情、简码、翻译、化学式、等等靠你想象
    # - lua_processor@*quick_symbol_text     #快符引导以及重复上屏，配合quick_symbol_text顶层配置清单定义扩展按键
    - ascii_composer                       #处理英文模式及中英文切换
    - recognizer                           #与 matcher 搭配，处理符合特定规则的输入码，如网址、反查等 tags
    - key_binder
    - lua_processor@*key_binder            #绑定按键扩展能力，支持正则扩展将按键生效情景更加细化
    - speller                              #拼写处理器，接受字符按键，编辑输入
    - punctuator                           #符号处理器，将单个字符按键直接映射为标点符号或文字
    - selector                             #选字处理器，处理数字选字键〔可以换成别的哦〕、上、下候选定位、换页
    - navigator                            #处理输入栏内的光标移动
    - express_editor                       #编辑器，处理空格、回车上屏、回退键
  segmentors:
    - ascii_segmentor                      #标识英文段落〔譬如在英文模式下〕字母直接上屛
    - matcher                              #配合 recognizer 标识符合特定规则的段落，如网址、反查等，加上特定 tag
    - abc_segmentor                        #标识常规的文字段落，加上 abc 这个 tag
    - affix_segmentor@wanxiang_reverse     #反查 tag
    - punct_segmentor                      #标识符号段落〔键入标点符号用〕加上 punct 这个 tag
    - fallback_segmentor                   #标识其他未标识段落，必须放在最后帮助tag模式切换后回退重新处理
  translators:
    - punct_translator                     #配合 punct_segmentor 转换标点符号
    - script_translator                    #脚本翻译器，用于拼音、粤拼等基于音节表的输入方案
    - echo_translator
    - table_translator
    - table_translator@wanxiang_reverse    #挂接部件组字和笔画反查
  filters:
    - reverse_lookup_filter@radical_reverse_lookup  #部件拆字滤镜，放在super_comment前面，进一步被超级注释处理以获得拼音编码的提示
    - lua_filter@*super_comment_preedit                     #超级注释模块，支持错词提示、辅助码显示，部件组字读音注释，支持个性化配置和关闭相应的功能，详情搜索super_comment进行详细配置
    - lua_filter@*super_lookup                      #字词输入中反查辅助筛选
    - lua_filter@*text_formatting_promote           #给自定义用户词扩展一个换行:\n, 制表符：\t, 回车符：\r, 空格：\s ，并对简码位置提升到第二位，同时保证英文前置避免无效派生干扰
    - uniquifier


translator:
  dictionary: wanxiang_mixedcode
  enable_user_dict: false
#  user_dict: zrm.userdb  # 用户词典的文件名称
#  db_class: tabledb  #开启后就不会产生zrm.userdb这样的文件夹，会直接输出文本zrm.txt同时无法使用同步能力
#  disable_user_dict_for_patterns:
#    - "^[a-z]{1,6}"    #基本的6码3字不调频
  enable_correction: false #是否开启自动纠错
  initial_quality: 3       # 初始质量拼音的权重应该比英文大
  spelling_hints: 50             # 将注释以词典字符串形式完全暴露，通过super_comment.lua完全接管，灵活配置。
  always_show_comments: true    # Rime 默认在 preedit 等于 comment 时取消显示 comment，这里强制一直显示，供super_comment.lua做判断用。
  comment_format: {comment}  #将注释以词典字符串形式完全暴露，通过super_comment.lua完全接管，灵活配置。
  preedit_format:     #影响到输入框的显示和“Shift+回车”上屏的字符，交给super_preedit处理
    - xform/7/¹/
    - xform/8/²/
    - xform/9/³/
    - xform/0/⁴/


# 部件拆字反查
wanxiang_reverse:
  tag: wanxiang_reverse
  dictionary: wanxiang_reverse
  db_class: stabledb
  enable_user_dict: false
  prefix: "`"  # 反查前缀（反查时前缀会消失影响打英文所以设定为两个字母，或可改成一个非字母符号），与 recognizer/patterns/radical_lookup 匹配
  tips: "〔反查：部件|笔画〕"

# 部件拆字滤镜
radical_reverse_lookup:
  tags: [ wanxiang_reverse ]  #起作用tag范围
  overwrite_comment: true   #是否覆盖其他提示
  dictionary: wanxiang_pro      #带音调的词典

# 处理符合特定规则的输入码，如网址、反查
recognizer:
  import_preset: default  # 从 default.yaml 继承通用的
  patterns:  # 再增加方案专有的：
    punct: "^/([0-9]|10|[A-Za-z]+)$"    # 响应 symbols.yaml 的 symbols
    wanxiang_reverse: "^`[A-Za-z]*$"        # 响应部件拆字与笔画的反查，与 radical_lookup/prefix 匹配

punctuator:
  digit_separators: ":,."  #数字分隔符
  __include: wanxiang_symbols:/symbol_table         # 从 symbols.yaml 导入配置

# 从 default 继承快捷键
key_binder:
  import_preset: default  # 从 default.yaml 继承通用的
  # Lua 配置: 超级tips上屏按键
  tips_key: "period"   #修改时候去default找
  bindings:             # 也可以再增加方案专有的
    #- { when: composing, accept: Tab, send: '[' } ## 取消注释后：tab引导辅助码
    - { when: composing, accept: Control+w, send: Control+BackSpace }
#分号用于次选，微软、搜狗双拼不可启用
    #- { when: has_menu, accept: semicolon, send: 2 }
#使用Control+e进入翻译模式
    - { when: has_menu, accept: "Control+e", toggle: chinese_english }
#通过快捷键Control+t开启超级tips
    - { when: has_menu, accept: "Control+t", toggle: super_tips }
#③ 翻页 - =
    - { when: has_menu, accept: minus, send: Page_Up }
    - { when: has_menu, accept: equal, send: Page_Down }
# Option/Alt + ←/→ 切换光标至下/上一个拼音
    - { when: composing, accept: Alt+Left, send: Shift+Left }
    - { when: composing, accept: Alt+Right, send: Shift+Right }
    - { when: always, toggle: ascii_punct, accept: Control+Shift+3 }              # 切换中英标点
    - { when: always, toggle: ascii_punct, accept: Control+Shift+numbersign }     # 切换中英标点
    - { when: always, accept: Control+Shift+space, select: .next }

editor:
  bindings:
    space: confirm                        # 空格键：上屏候选项
    Return: commit_raw_input              # 回车键：上屏原始输入
    Control+Return: commit_script_text    # Ctrl+回车键：上屏变换后输入（经过 preedit转换的）
    Control+Shift+Return: commit_comment  # Ctrl+Shift+回车键：上屏 comment
    BackSpace: revert                     # 退格键：向前删除（撤消上次输入）
    Delete: delete                        # Delete 键：向后删除
    Control+BackSpace: back_syllable      # Ctrl+退格键：删除一个音节
    Control+Delete: delete_candidate      # Ctrl+Delete键：删除或降权候选项
    Escape: cancel                        # Esc 键：取消输入


# 拼写设定
speller:
# table_translator翻译器，支持自动上屏。例如 “zmhu”可以自动上屏“怎么回事”
#  auto_select: true
#  auto_select_pattern: ^[a-z]+/|^[a-df-zA-DF-Z]\w{3}|^e\w{4}
  # 如果不想让什么标点直接上屏，可以加在 alphabet，或者编辑标点符号为两个及以上的映射
  alphabet: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA7890`;/
  # initials 定义仅作为始码的按键，排除 ` 让单个的 ` 可以直接上屏
  initials: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA/`
  delimiter: " '"
  algebra:
    __include: set_shuru_schema


通用派生规则:
  # 数字派生，先将整数类派生出英文写法
  - derive/(?<!\d)1([1-9])(?!\d)/'shí'$1/
  - derive/([1-9])0000(?!0)/$1'wàn'/
  - derive/([1-9])000(?!0)/$1'qiān'/
  - derive/([1-9])00(?!0)/$1'bǎi'/
  - derive/([2-9])0(?!0)/$1'shí'/
  - derive/(?<!\d)([2-9])([1-9])(?!\d)/$1'shí'$2/
  - derive/1([4-7|9])/$1'teen'/
  - derive/11/'eleven'/
  - derive/12/'twelve'/
  - derive/13/'thirteen'/
  - derive/15/'fifteen'/
  - derive/18/'eighteen'/
  - derive/0/o/
  - derive/0/O/
  - derive/0/'zero'/
  - derive/1/'one'/
  - derive/10/'ten'/
  - derive/2/'to'/
  - derive/2/'two'/
  - derive/3/'three'/
  - derive/4/'for'/
  - derive/4/'four'/
  - derive/5/'five'/
  - derive/6/'six'/
  - derive/7/'seven'/
  - derive/8/'eight'/
  - derive/9/'nine'/
  - derive/10/'shí'/
  - derive/0/'líng'/
  - derive/1/'yī'/
  - derive/2/'èr'/
  - derive/3/'sān'/
  - derive/4/'sì'/
  - derive/5/'wǔ'/
  - derive/6/'liù'/
  - derive/7/'qī'/
  - derive/8/'bā'/
  - derive/9/'jiǔ'/
  # 符号派生，将编码中的符号，该消失的消失，该转换为名称的转换为名称
  - derive/\+/'plus'/
  - derive/\./'dot'/
  - derive/@/'at'/
  - derive/-/'hyphen'/
  - derive/#/'hash'/
  - derive/#/'number'/
  - derive/#/'sharp'/
  - derive/♯/'sharp'/
  - derive / 'slash'
  - derive/&/'and'/
  - derive/%/'percent'/
  # 派生单个特殊字符需要消失的转换为'分隔符，需要转换为拼音的放在具体的输入布局转写中
  - derive/--/'jiǎn'jiǎn'/   #两个连续减号转换为jiǎn'jiǎn
  - derive/^(.*)-$/$1'jiǎn/      #单个减号末尾的转换为jiǎn
  - derive/-/'/                  #中间减号一般无意义，转换为分隔符以忽略
  - derive/_/'/
  - derive/\./'diǎn'/
  - derive/\+/'jiā'/
  - derive/·/'/
  - derive/#/'jǐng'/
  - derive/[@]/'ài'tè'/
  - derive/[@]/'quān'a'/
  - xform/'+/'/
  - xform/^'(.*)$/$1/
  - xform/^(.*)'$/$1/
全拼:
  __include: 通用派生规则
  __append:
    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - xform/'//
    - derive/^([nl])ue$/$1ve/
    - derive/'([nl])ue$/'$1ve/
    - derive/^([jqxy])u/$1v/
    - derive/'([jqxy])u/'$1v/
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/
    - derive/(.+$)/$1;/


    
自然码:
  __include: 通用派生规则
  __append:
    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - derive/('|^)([jqxy])u(?=^|$|')/$1$2v/
    - derive/('|^)([aoe])([ioun])(?=^|$|')/$1$2$2$3/
    - xform/('|^)([aoe])(ng)?(?=^|$|')/$1$2$2$3/
    - xform/('|^)([qdjlxnm])iu(?=^|$|')/$1$2<q>/
    - xform/('|^)([tghkljx])[iu]a(?=^|$|')/$1$2<w>/
    - xform/('|^)([qyjlxn])[uv]e(?=^|$|')/$1$2<t>/
    - xform/^sh/<u>/
    - xform/^ch/<i>/
    - xform/^zh/<v>/
    - xform/'sh/'<u>/
    - xform/'ch/'<i>/
    - xform/'zh/'<v>/
    - xform/('|^)([qtypdjlxnm])ing(?=^|$|')|('|^)((?:<i>|<u>|[gh]))uai(?=^|$|')/$1$2<y>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxcn]))[uv]an(?=^|$|')/$1$2<r>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghklzcn]))uo(?=^|$|')/$1$2<o>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxc]))[uv]n(?=^|$|')/$1$2<p>/
    - xform/('|^)((?:<v>|<i>|[qrtysdghjklzxcn]))i?ong(?=^|$|')/$1$2<s>/
    - xform/('|^)((?:<v>|<i>|<u>|[aoeqghjkxbn]))[iu]ang(?=^|$|')/$1$2<d>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghkzcbnm]))en(?=^|$|')/$1$2<f>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghklzcbnm]))eng(?=^|$|')/$1$2<g>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))ang(?=^|$|')/$1$2<h>/
    - xform/('|^)([qtpdjlxbnm])ian(?=^|$|')/$1$2<m>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))an(?=^|$|')/$1$2<j>/
    - xform/('|^)([qtpdjlxbnm])iao(?=^|$|')/$1$2<c>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdghklzcbnm]))ao(?=^|$|')/$1$2<k>/
    - xform/('|^)((?:<i>|<u>|[aoewtpsdghklzcbnm]))ai(?=^|$|')/$1$2<l>/
    - xform/('|^)((?:<v>|[aoewtpdfghklzvbnm]))ei(?=^|$|')/$1$2<z>/
    - xform/('|^)([qtpdjlxbnm])ie(?=^|$|')/$1$2<x>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghkzc]))ui(?=^|$|')/$1$2<v>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdfghklzm]))ou(?=^|$|')/$1$2<b>/
    - xform/('|^)([qypjlmnbx])in(?=^|$|')/$1$2<n>/
    - xform/'|<|>//
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/
小鹤双拼:
  __include: 通用派生规则
  __append:
    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - derive/('|^)([jqxy])u(?=^|$|')/$1$2v/
    - derive/('|^)([aoe])([ioun])(?=^|$|')/$1$2$2$3/
    - xform/('|^)([aoe])(ng)?(?=^|$|')/$1$2$2$3/
    - xform/('|^)([tghkl])iu(?=^|$|')/$1$2<q>/
    - xform/('|^)((?:<v>|[aoewtpdfghklzvbnm]))ei(?=^|$|')/$1$2<w>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxcn]))uan(?=^|$|')/$1$2<r>/
    - xform/('|^)([qyjlxn])[uv]e(?=^|$|')/$1$2<t>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxc]))un(?=^|$|')/$1$2<y>/
    - xform/^sh/<u>/
    - xform/^ch/<i>/
    - xform/^zh/<v>/
    - xform/'sh/'<u>/
    - xform/'ch/'<i>/
    - xform/'zh/'<v>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghklzcn]))uo(?=^|$|')/$1$2<o>/
    - xform/('|^)([qtpdjlxbnm])ie(?=^|$|')/$1$2<p>/
    - xform/('|^)((?:<v>|<i>|[qrtysdghjklzxcn]))i?ong(?=^|$|')/$1$2<s>/
    - xform/('|^)([qtypdjlxnm])ing(?=^|$|')|('|^)((?:<i>|<u>|[gh]))uai(?=^|$|')/$1$2<k>/
    - xform/('|^)((?:<i>|<u>|[aoewtpsdghklzcbnm]))ai(?=^|$|')/$1$2<d>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghkzcbnm]))en(?=^|$|')/$1$2<f>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghklzcbnm]))eng(?=^|$|')/$1$2<g>/
    - xform/('|^)((?:<v>|<i>|<u>|[aoeqghjkxbn]))[iu]ang(?=^|$|')/$1$2<l>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))ang(?=^|$|')/$1$2<h>/
    - xform/('|^)([qtpdjlxbnm])ian(?=^|$|')/$1$2<m>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))an(?=^|$|')/$1$2<j>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdfghklzm]))ou(?=^|$|')/$1$2<z>/
    - xform/('|^)([tghkljx])[iu]a(?=^|$|')/$1$2<x>/
    - xform/('|^)([qtpdjlxbnm])iao(?=^|$|')/$1$2<n>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdghklzcbnm]))ao(?=^|$|')/$1$2<c>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghkzc]))ui(?=^|$|')/$1$2<v>/
    - xform/('|^)([qypjlmnbx])in(?=^|$|')/$1$2<b>/
    - xform/'|<|>//
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/
微软双拼:
  __include: 通用派生规则
  __append:
    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - derive/('|^)([jqxy])u(?=^|$|')/$1$2v/
    - derive/('|^)([aoe].*)(?=^|$|')/$1o$2/
    - xform/('|^)([ae])(.*)(?=^|$|')/$1$2$2$3/
    - xform/('|^)([tghkl])iu(?=^|$|')/$1$2<q>/
    - xform/('|^)([tghkljx])[iu]a(?=^|$|')/$1$2<w>/
    - xform/('|^)er(?=^|$|')|('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxcn]))[uv]an(?=^|$|')/$1$2<r>/
    - xform/('|^)([qyjlxn])[uv]e(?=^|$|')/$1$2<t>/
    - xform/('|^)([yjlx])v(?=^|$|')|('|^)((?:<i>|<u>|[gh]))uai(?=^|$|')/$1$2<y>/
    - xform/^sh/<u>/
    - xform/^ch/<i>/
    - xform/^zh/<v>/
    - xform/'sh/'<u>/
    - xform/'ch/'<i>/
    - xform/'zh/'<v>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghklzcn]))uo(?=^|$|')/$1$2<o>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxc]))[uv]n(?=^|$|')/$1$2<p>/
    - xform/('|^)((?:<v>|<i>|[qrtysdghjklzxcn]))i?ong(?=^|$|')/$1$2<s>/
    - xform/('|^)((?:<v>|<i>|<u>|[aoeqghjkxbn]))[iu]ang(?=^|$|')/$1$2<d>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghkzcbnm]))en(?=^|$|')/$1$2<f>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghklzcbnm]))eng(?=^|$|')/$1$2<g>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))ang(?=^|$|')/$1$2<h>/
    - xform/('|^)([qtpdjlxbnm])ian(?=^|$|')/$1$2<m>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))an(?=^|$|')/$1$2<j>/
    - xform/('|^)([qtpdjlxbnm])iao(?=^|$|')/$1$2<c>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdghklzcbnm]))ao(?=^|$|')/$1$2<k>/
    - xform/('|^)((?:<i>|<u>|[aoewtpsdghklzcbnm]))ai(?=^|$|')/$1$2<l>/
    - xform/('|^)((?:<v>|[aoewtpdfghklzvbnm]))ei(?=^|$|')/$1$2<z>/
    - xform/('|^)([qtpdjlxbnm])ie(?=^|$|')/$1$2<x>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghkzc]))ui(?=^|$|')/$1$2<v>/
    - derive/<t>(?=^|$|')/<v>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdfghklzm]))ou(?=^|$|')/$1$2<b>/
    - xform/('|^)([qypjlmnbx])in(?=^|$|')/$1$2<n>/
    - xform/('|^)([qtypdjlxnm])ing(?=^|$|')/$1$2;/
    - xform/'|<|>//
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/
搜狗双拼:
  __include: 通用派生规则
  __append:
    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - derive/('|^)([jqxy])u(?=^|$|')/$1$2v/
    - derive/('|^)([aoe].*)(?=^|$|')/$1o$2/
    - xform/('|^)([ae])(.*)(?=^|$|')/'$1$2$2$3/
    - xform/('|^)([tghkl])iu(?=^|$|')/$1$2<q>/
    - xform/('|^)([tghkljx])[iu]a(?=^|$|')/<w>/
    - xform/('|^)er(?=^|$|')/$1<r>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxcn]))[uv]an(?=^|$|')/$1$2<r>/
    - xform/('|^)([qyjlxn])[uv]e(?=^|$|')/$1$2<t>/
    - xform/('|^)([yjlx])v(?=^|$|')|('|^)((?:<i>|<u>|[gh]))uai(?=^|$|')/$1$2<y>/
    - xform/^sh/<u>/
    - xform/^ch/<i>/
    - xform/^zh/<v>/
    - xform/'sh/'<u>/
    - xform/'ch/'<i>/
    - xform/'zh/'<v>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghklzcn]))uo(?=^|$|')/$1$2<o>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxc]))[uv]n(?=^|$|')/$1$2<p>/
    - xform/('|^)((?:<v>|<i>|[qrtysdghjklzxcn]))i?ong(?=^|$|')/$1$2<s>/
    - xform/('|^)((?:<v>|<i>|<u>|[aoeqghjkxbn]))[iu]ang(?=^|$|')/$1$2<d>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghkzcbnm]))en(?=^|$|')/$1$2<f>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghklzcbnm]))eng(?=^|$|')/$1$2<g>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))ang(?=^|$|')/$1$2<h>/
    - xform/('|^)([qtpdjlxbnm])ian(?=^|$|')/$1$2<m>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))an(?=^|$|')/$1$2<j>/
    - xform/('|^)([qtpdjlxbnm])iao(?=^|$|')/$1$2<c>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdghklzcbnm]))ao(?=^|$|')/$1$2<k>/
    - xform/('|^)((?:<i>|<u>|[aoewtpsdghklzcbnm]))ai(?=^|$|')/$1$2<l>/
    - xform/('|^)((?:<v>|[aoewtpdfghklzvbnm]))ei(?=^|$|')/$1$2<z>/
    - xform/('|^)([qtpdjlxbnm])ie(?=^|$|')/$1$2<x>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghkzc]))ui(?=^|$|')/$1$2<v>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdfghklzm]))ou(?=^|$|')/$1$2<b>/
    - xform/('|^)([qypjlmnbx])in(?=^|$|')/$1$2<n>/
    - xform/('|^)([qtypdjlxnm])ing(?=^|$|')/$1$2;/
    - xform/'|<|>//
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/

智能ABC:
  __include: 通用派生规则
  __append:
    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - xform/^zh/<a>/
    - xform/^ch/<e>/
    - xform/^sh/<v>/
    - xform/'zh/'<a>/
    - xform/'ch/'<e>/
    - xform/'sh/'<v>/
    - xform/('|^)([aoe].*)(?=^|$|')/$1<o>$2/
    - xform/('|^)((?:<v>|[aoewtpdfghklzvbnm]))ei(?=^|$|')/$1$2<q>/
    - xform/('|^)([qtpdjlxbnm])ian(?=^|$|')/$1$2<w>/
    - xform/('|^)er(?=^|$|')/$1<r>/
    - xform/('|^)([tghkl])iu(?=^|$|')/$1$2<r>/
    - xform/('|^)((?:<v>|<i>|<u>|[aoeqghjkxbn]))[iu]ang(?=^|$|')/$1$2<t>/
    - xform/('|^)([qtypdjlxnm])ing(?=^|$|')/$1$2<y>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghklzcn]))uo(?=^|$|')/$1$2<o>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxcn]))uan(?=^|$|')/$1$2<p>/
    - xform/('|^)((?:<v>|<i>|[qrtysdghjklzxcn]))i?ong(?=^|$|')/$1$2<s>/
    - xform/('|^)([tghkljx])[iu]a(?=^|$|')/$1$2<d>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghkzcbnm]))en(?=^|$|')/$1$2<f>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghklzcbnm]))eng(?=^|$|')/$1$2<g>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))ang(?=^|$|')/$1$2<h>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))an(?=^|$|')/$1$2<j>/
    - xform/('|^)([qtpdjlxbnm])iao(?=^|$|')/$1$2<z>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdghklzcbnm]))ao(?=^|$|')/$1$2<k>/
    - xform/('|^)([qypjlmnbx])in(?=^|$|')|('|^)((?:<i>|<u>|[gh]))uai(?=^|$|')/$1$2<c>/
    - xform/('|^)((?:<i>|<u>|[aoewtpsdghklzcbnm]))ai(?=^|$|')/$1$2<l>/
    - xform/('|^)([qtpdjlxbnm])ie(?=^|$|')/$1$2<x>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdfghklzm]))ou(?=^|$|')/$1$2<b>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxc]))un(?=^|$|')/$1$2<n>/
    - xform/('|^)([qyjlxn])[uv]e(?=^|$|')|('|^)((?:<v>|<i>|<u>|[tsdghkzc]))ui(?=^|$|')/$1$2<m>/
    - xform/'|<|>//
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/

紫光双拼:
  __include: 通用派生规则
  __append:
    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - derive/('|^)([jqxy])u(?=^|$|')/$1$2v/
    - xform/('|^)([aoe].*)(?=^|$|')/$1<o>$2/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghkzcbnm]))en(?=^|$|')/$1$2<w>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghklzcbnm]))eng(?=^|$|')/$1$2<t>/
    - xform/('|^)([qypjlmnbx])in(?=^|$|')|('|^)((?:<i>|<u>|[gh]))uai(?=^|$|')/$1$2<y>/
    - xform/^zh/<u>/
    - xform/^sh/<i>/
    - xform/'zh/'<u>/
    - xform/'sh/'<i>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghklzcn]))uo(?=^|$|')/$1$2<o>/
    - xform/('|^)((?:<i>|<u>|[aoewtpsdghklzcbnm]))ai(?=^|$|')/$1$2<p>/
    - xform/^ch/<a>/
    - xform/'ch/'<a>/
    - xform/('|^)((?:<v>|<i>|<u>|[aoeqghjkxbn]))[iu]ang(?=^|$|')/$1$2<g>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))ang(?=^|$|')/$1$2<s>/
    - xform/('|^)([qtpdjlxbnm])ie(?=^|$|')/$1$2<d>/
    - xform/('|^)([qtpdjlxbnm])ian(?=^|$|')/$1$2<f>/
    - xform/('|^)((?:<v>|<i>|[qrtysdghjklzxcn]))i?ong(?=^|$|')/$1$2<h>/
    - xform/('|^)er(?=^|$|')/$1<j>/
    - xform/('|^)([tghkl])iu(?=^|$|')/$1$2<j>/
    - xform/('|^)((?:<v>|[aoewtpdfghklzvbnm]))ei(?=^|$|')/$1$2<k>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxcn]))uan(?=^|$|')/$1$2<l>/
    - xform/('|^)([qtypdjlxnm])ing(?=^|$|')/$1$2;/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdfghklzm]))ou(?=^|$|')/$1$2<z>/
    - xform/('|^)([tghkljx])[iu]a(?=^|$|')/$1$2<x>/
    - xform/('|^)([qtpdjlxbnm])iao(?=^|$|')/$1$2<b>/
    - xform/('|^)([qyjx])ue(?=^|$|')|('|^)((?:<v>|<i>|<u>|[tsdghkzc]))ui(?=^|$|')|('|^)([ln])ve(?=^|$|')/$1$2<n>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxc]))un(?=^|$|')/$1$2<m>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdghklzcbnm]))ao(?=^|$|')/$1$2<q>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))an(?=^|$|')/$1$2<r>/
    - xform/'|<|>//
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/

拼音加加:
  __include: 通用派生规则
  __append:
    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - derive/('|^)([jqxy])u(?=^|$|')/$1$2v/
    - derive/('|^)([aoe])([ioun])(?=^|$|')/$1$2$2$3/
    - xform/('|^)([aoe])(ng)?(?=^|$|')/$1$2$2$3/
    - xform/('|^)([tghkl])iu(?=^|$|')/$1$2<n>/
    - xform/('|^)([tghkljx])[iu]a(?=^|$|')/$1$2<b>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxcn]))[uv]an(?=^|$|')/$1$2<c>/
    - xform/('|^)((?:<i>|<u>|[gh]))uai(?=^|$|')|('|^)([qyjlxn])[uv]e(?=^|$|')/$1$2<x>/
    - xform/('|^)([qtypdjlxnm])ing(?=^|$|')|('|^)er(?=^|$|')/$1$2<q>/
    - xform/^sh/<i>/
    - xform/^ch/<u>/
    - xform/^zh/<v>/
    - xform/'sh/'<i>/
    - xform/'ch/'<u>/
    - xform/'zh/'<v>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghklzcn]))uo(?=^|$|')/$1$2<o>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxc]))[uv]n(?=^|$|')/$1$2<z>/
    - xform/('|^)((?:<v>|<i>|[qrtysdghjklzxcn]))i?ong(?=^|$|')/$1$2<y>/
    - xform/('|^)((?:<v>|<i>|<u>|[aoeqghjkxbn]))[iu]ang(?=^|$|')/$1$2<h>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghkzcbnm]))en(?=^|$|')/$1$2<r>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghklzcbnm]))eng(?=^|$|')/$1$2<t>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))ang(?=^|$|')/$1$2<g>/
    - xform/('|^)([qtpdjlxbnm])ian(?=^|$|')/$1$2<j>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))an(?=^|$|')/$1$2<f>/
    - xform/('|^)([qtpdjlxbnm])iao(?=^|$|')/$1$2<k>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdghklzcbnm]))ao(?=^|$|')/$1$2<d>/
    - xform/('|^)((?:<i>|<u>|[aoewtpsdghklzcbnm]))ai(?=^|$|')/$1$2<s>/
    - xform/('|^)((?:<v>|[aoewtpdfghklzvbnm]))ei(?=^|$|')/$1$2<w>/
    - xform/('|^)([qtpdjlxbnm])ie(?=^|$|')/$1$2<m>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghkzc]))ui(?=^|$|')/$1$2<v>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdfghklzm]))ou(?=^|$|')/$1$2<p>/
    - xform/('|^)([qypjlmnbx])in(?=^|$|')/$1$2<l>/
    - xform/'|<|>//
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/
国标双拼:
  __include: 通用派生规则
  __append:
    - xlit/āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü/aaaaooooeeeeiiiiuuuuvvvvv/
    - derive/^([aoe])([ioun])(?=^|$|')/$1$1$2/
    - derive/'([aoe])([ioun])(?=^|$|')/'$1$1$2/
    - xform/^([aoe])(ng)?(?=^|$|')/$1$1$2/
    - xform/'([aoe])(ng)?(?=^|$|')/'$1$1$2/
    - xform/('|^)([tghkljx])iu(?=^|$|')/$1$2<y>/
    - xform/('|^)((?:<v>|[aoewtpdfghklzvbnm]))ei(?=^|$|')/$1$2<b>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxcn]))uan(?=^|$|')/$1$2<w>/
    - xform/('|^)([qyjlxn])[uv]e(?=^|$|')/$1$2<x>/
    - xform/('|^)((?:<v>|<i>|<u>|[qrtysdghjklzxc]))un(?=^|$|')/$1$2<z>/
    - xform/^sh/<u>/
    - xform/^ch/<i>/
    - xform/^zh/<v>/
    - xform/'sh/'<u>/
    - xform/'ch/'<i>/
    - xform/'zh/'<v>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghklzcn]))uo(?=^|$|')/$1$2<o>/
    - xform/('|^)([qtpdjlxbnm])ie(?=^|$|')/$1$2<t>/
    - xform/('|^)((?:<v>|<i>|[qrtysdghjklzxcn]))i?ong(?=^|$|')/$1$2<s>/
    - xform/('|^)([qtypdjlxnm])ing(?=^|$|')|('|^)((?:<i>|<u>|[gh]))uai(?=^|$|')/$1$2<j>/
    - xform/('|^)((?:<i>|<u>|[aoewtpsdghklzcbnm]))ai(?=^|$|')/$1$2<k>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghkzcbnm]))en(?=^|$|')/$1$2<r>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtpsdfghklzcbnm]))eng(?=^|$|')/$1$2<h>/
    - xform/('|^)((?:<v>|<i>|<u>|[aoeqghjkxbn]))[iu]ang(?=^|$|')/$1$2<n>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))ang(?=^|$|')/$1$2<g>/
    - xform/('|^)([qtpdjlxbnm])ian(?=^|$|')/$1$2<d>/
    - xform/('|^)((?:<v>|<i>|<u>|[wrtypsdfghklzcbnm]))an(?=^|$|')/$1$2<f>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdfghklzm]))ou(?=^|$|')/$1$2<p>/
    - xform/('|^)([tghkljx])[iu]a(?=^|$|')/$1$2<q>/
    - xform/('|^)([qtpdjlxbnm])iao(?=^|$|')/$1$2<m>/
    - xform/('|^)((?:<v>|<i>|<u>|[rtypsdghklzcbnm]))ao(?=^|$|')/$1$2<c>/
    - xform/('|^)((?:<v>|<i>|<u>|[tsdghkzc]))ui(?=^|$|')/$1$2<v>/
    - xform/('|^)([qypjlmnbx])in(?=^|$|')/$1$2<l>/
    - xform/'|<|>//
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/
  # 前 2~10 个字母大写
  #- derive/^([a-z]{2})/\U$1/
  #- derive/^([a-z]{3})/\U$1/
  #- derive/^([a-z]{4})/\U$1/
  #- derive/^([a-z]{5})/\U$1/
  #- derive/^([a-z]{6})/\U$1/
  #- derive/^([a-z]{7})/\U$1/
  #- derive/^([a-z]{8})/\U$1/
  #- derive/^([a-z]{9})/\U$1/
  #- derive/^([a-z]{10})/\U$1/
  # 全小写
  #- derive/^.+$/\L$0/
  # 全大写
  #- derive/^.+$/\U$0/
  # 首字母大写
  #- derive/^./\U$0/

自然龙:
  __include: 通用派生规则
  __append:
    - xform/('|^)(ā|á|ǎ|à)([ioun])(?=^|$|')/'a$2$3/
    - xform/('|^)(ō|ó|ǒ|ò)([ioun])(?=^|$|')/'o$2$3/
    - xform/('|^)(ē|é|ě|è)([ioun])(?=^|$|')/'e$2$3/
    - xform/('|^)(ā|á|ǎ|à)(ng)(?=^|$|')/'a$2$3/
    - xform/('|^)(ō|ó|ǒ|ò)(ng)(?=^|$|')/'o$2$3/
    - xform/('|^)(ē|é|ě|è)(ng)(?=^|$|')/'e$2$3/
    - xform/('|^)(ā|á|ǎ|à)(?=^|$|')/'a$2/
    - xform/('|^)(ō|ó|ǒ|ò)(?=^|$|')/'o$2/
    - xform/('|^)(ē|é|ě|è)(?=^|$|')/'e$2/
    - xform/(')([jqxy])u(?=^|$|')/'$2ü/
    - xform/('|^)([jqxy])ū(?=^|$|')/'$2ǖ/
    - xform/('|^)([jqxy])ú(?=^|$|')/'$2ǘ/
    - xform/('|^)([jqxy])ǔ(?=^|$|')/'$2ǚ/
    - xform/('|^)([jqxy])ù(?=^|$|')/'$2ǜ/
    - xform/('|^)ǹg(?=^|$|')/'eèng/
    - xform/('|^)ňg(?=^|$|')/'eěng/
    - xform/('|^)ńg(?=^|$|')/'eéng/
    - xform/('|^)ng(?=^|$|')/'eeng/
    - xform/('|^)ǹ(?=^|$|')/'eèn/
    - xform/('|^)ň(?=^|$|')/'eěn/
    - xform/('|^)ń(?=^|$|')/'eén/
    - xform/('|^)n(?=^|$|')/'een/
    - xform/('|^)ēr(?=^|$|')/'e<q>/
    - xform/('|^)ér(?=^|$|')/'e<k>/
    - xform/('|^)ěr(?=^|$|')/'e<u>/
    - xform/('|^)èr(?=^|$|')/'e<h>/
    - xform/('|^)er(?=^|$|')/'e<q>/
    - xform/('|^)a(?=^|$|')/'aā/
    - xform/('|^)o(?=^|$|')/'oō/
    - xform/('|^)e(?=^|$|')/'eē/
    - xform/'sh/'u/
    - xform/'ch/'i/
    - xform/'zh/'v/
    - xform/^sh(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/u/
    - xform/^ch(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/i/
    - xform/^zh(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/v/
    - xform/('|^)([a-z])(iáo|iǎng|uǎng|āng|uē|üe|ǖe|ǎi|á)(?=^|$|')/$1$2<u>/
    - xform/('|^)([a-z])(iàng|iǒng|uàng|ēn|īng|é|ó)(?=^|$|')/$1$2<e>/
    - xform/('|^)([a-z])(iǎn|iōng|uǎi|uò|ǎng|ō)(?=^|$|')/$1$2<p>/
    - xform/('|^)([a-z])(uāng|ǐng|ìng|uí|áng)(?=^|$|')/$1$2<w>/
    - xform/('|^)([a-z])(uǎn|uái||uā|én|uō|ié|ǚ)(?=^|$|')/$1$2<s>/
    - xform/('|^)([a-z])(uán|ài|ěn|èn|uě|ǚe|ǎn|ǔn|iù)(?=^|$|')/$1$2<o>/
    - xform/('|^)([a-z])(uān|àng|ái|iā|uè|üè)(?=^|$|')/$1$2<d>/
    - xform/('|^)([a-z])(iáng|áo|ué|üé|ēi|à|è|ǒ)(?=^|$|')/$1$2<i>/
    - xform/('|^)([a-z])(uāi|uà|uǎ|ūn|ò|ǐ)(?=^|$|')/$1$2<g>/
    - xform/('|^)([a-z])(éng|èng|uài|èi|uì|ǜ|ún)(?=^|$|')/$1$2<f>/
    - xform/('|^)([a-z])(ióng|ōng|án|iē|ie)(?=^|$|')/$1$2<k>/
    - xform/('|^)([a-z])(iào|iǎo|uǒ|uó|a|ā|ě|ú)(?=^|$|')/$1$2<l>/
    - xform/('|^)([a-z])(uàn|ēng|eng|iá|ín|iě)(?=^|$|')/$1$2<c>/
    - xform/('|^)([a-z])(iān|òu|éi|ùn|ē)(?=^|$|')/$1$2<r>/
    - xform/('|^)([a-z])(iāng|ěng|òng)(?=^|$|')/$1$2<y>/
    - xform/('|^)([a-z])(iāo|ǔ|ǎ|iú|ǘ)(?=^|$|')/$1$2<m>/
    - xform/('|^)([a-z])(iǎ|íng|ān|ǒng)(?=^|$|')/$1$2<n>/
    - xform/('|^)([a-z])(iòng|īn|ǖ|ù)(?=^|$|')/$1$2<h>/
    - xform/('|^)([a-z])(ǎo|ià|ǐn|ōu|ou)(?=^|$|')/$1$2<x>/
    - xform/('|^)([a-z])(óng|àn|ěi|ī|i)(?=^|$|')/$1$2<j>/
    - xform/('|^)([a-z])(ián|ào|ìn|uǐ)(?=^|$|')/$1$2<v>/
    - xform/('|^)([a-z])(uáng|āi|í)(?=^|$|')/$1$2<b>/
    - xform/('|^)([a-z])(ǒu|iū|iǔ|iu)(?=^|$|')/$1$2<z>/
    - xform/('|^)([a-z])(uá|uī|ì)(?=^|$|')/$1$2<t>/
    - xform/('|^)([a-z])(ū|óu|iàn)(?=^|$|')/$1$2<a>/
    - xform/('|^)([a-z])(āo|iè)(?=^|$|')/$1$2<q>/
    # 兼容及收尾区
    - xform/(')([a-z])ei(?=^|$|')/$1$2<i>/
    - xform/(')([a-z])un(?=^|$|')/$1$2<g>/
    - xform/(')([a-z])an(?=^|$|')/$1$2<n>/
    - xform/(')([a-z])ai(?=^|$|')/$1$2<b>/
    - xform/(')([a-z])in(?=^|$|')/$1$2<h>/
    - xform/(')([a-z])iao(?=^|$|')/$1$2<m>/
    - xform/(')([a-z])iang(?=^|$|')/$1$2<y>/
    - xform/(')([a-z])ui(?=^|$|')/$1$2<t>/
    - xform/(')([a-z])u(?=^|$|')/$1$2<a>/
    - xform/(')([a-z])ao(?=^|$|')/$1$2<q>/
    - xform/(')([a-z])e(?=^|$|')/$1$2<r>/
    - xform/'|<|>//
    - derive/al/a/    # 中英文兼容,aā⇋a
    - derive/op/o/    # 中英文兼容,oō⇋o
    # 同理(应对中英混输中英文部分不在首位且全小写还被正则匹配到的情况,暂时注释)
    # - derive/([a-z])i/$1ei/
    # - derive/([a-z])g/$1un/
    # - derive/([a-z])n/$1an/
    # - derive/([a-z])b/$1ai/
    # - derive/([a-z])h/$1in/
    # - derive/([a-z])m/$1iao/
    # - derive/([a-z])y/$1iang/
    # - derive/([a-z])t/$1ui/
    # - derive/([a-z])a/$1u/
    # - derive/([a-z])q/$1ao/
    # - derive/([a-z])r/$1e/
    # - derive/sh/u/
    # - derive/ch/i/
    # - derive/zh/v/
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/

汉心龙:
  __include: 通用派生规则
  __append:
    - xform/('|^)(ā|á|ǎ|à)([ioun])(?=^|$|')/'<q>$2$3/
    - xform/('|^)(ō|ó|ǒ|ò)([ioun])(?=^|$|')/'<r>$2$3/
    - xform/('|^)(ē|é|ě|è)([iounr])(?=^|$|')/'<b>$2$3/
    - xform/('|^)(ā|á|ǎ|à)(ng)(?=^|$|')/'<q>$2$3/
    - xform/('|^)(ō|ó|ǒ|ò)(ng)(?=^|$|')/'<r>$2$3/
    - xform/('|^)(ē|é|ě|è)(ng)(?=^|$|')/'<b>$2$3/
    - xform/('|^)(a|ā|á|ǎ|à)(?=^|$|')/'<q>$2/
    - xform/('|^)(o|ō|ó|ǒ|ò)(?=^|$|')/'<r>$2/
    - xform/('|^)(e|ē|é|ě|è)(?=^|$|')/'<b>$2/
    - xform/(')([jqxy])u(?=^|$|')/'$2ü/
    - xform/('|^)([jqxy])ū(?=^|$|')/'$2ǖ/
    - xform/('|^)([jqxy])ú(?=^|$|')/'$2ǘ/
    - xform/('|^)([jqxy])ǔ(?=^|$|')/'$2ǚ/
    - xform/('|^)([jqxy])ù(?=^|$|')/'$2ǜ/
    - xform/('|^)ǹg(?=^|$|')/'<b>èng/
    - xform/('|^)ňg(?=^|$|')/'<b>ěng/
    - xform/('|^)ńg(?=^|$|')/'<b>éng/
    - xform/('|^)ng(?=^|$|')/'<b>eng/
    - xform/('|^)ǹ(?=^|$|')/'<b>èn/
    - xform/('|^)ň(?=^|$|')/'<b>ěn/
    - xform/('|^)ń(?=^|$|')/'<b>én/
    - xform/('|^)n(?=^|$|')/'<b>en/
    - xform/('|^)sh(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<t>/
    - xform/('|^)ch(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<s>/
    - xform/('|^)zh(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<k>/
    - xform/('|^)a(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<q>/
    - xform/('|^)p(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<w>/
    - xform/('|^)j(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<e>/
    - xform/('|^)o(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<r>/
    - xform/('|^)n(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<y>/
    - xform/('|^)k(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<u>/
    - xform/('|^)b(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<i>/
    - xform/('|^)c(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<x>/
    - xform/('|^)t(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<o>/
    - xform/('|^)m(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<p>/
    - xform/('|^)q(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<a>/
    - xform/('|^)l(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<d>/
    - xform/('|^)r(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<f>/
    - xform/('|^)w(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<g>/
    - xform/('|^)d(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<h>/
    - xform/('|^)y(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<j>/
    - xform/('|^)g(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<l>/
    - xform/('|^)s(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<z>/
    - xform/('|^)x(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<c>/
    - xform/('|^)f(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<v>/
    - xform/('|^)e(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<b>/
    - xform/('|^)z(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<n>/
    - xform/('|^)h(?=([iuü]?[āáǎàōóǒòēéěèīíǐìūúǔùǖǘǚǜü]))(?!$|')/'<m>/
    - xform/('|^)<([a-z])>(āi|ai|óng|ìng|uāng|uang|á|ēr|er|iǎ)(?=^|$|')/$1$2<a>/
    - xform/('|^)<([a-z])>(ài|ián|üě|uě|uí|uǎn|uàng|ǘ)(?=^|$|')/$1$2<b>/
    - xform/('|^)<([a-z])>(ǔ|uàn)(?=^|$|')/$1$2<c>/
    - xform/('|^)<([a-z])>(ǒu|èi|é|iāo|iao|iá)(?=^|$|')/$1$2<d>/
    - xform/('|^)<([a-z])>(ü|ǖ|iù|ā|a|uì|uǎng)(?=^|$|')/$1$2<e>/
    - xform/('|^)<([a-z])>(ǐ|uān|uan|uà|ò|uǎ)(?=^|$|')/$1$2<f>/
    - xform/('|^)<([a-z])>(ī|i|ěn|ěi|uáng)(?=^|$|')/$1$2<g>/
    - xform/('|^)<([a-z])>(ǜ|ēng|eng|iē|ie|éi|ún|uāi|uai)(?=^|$|')/$1$2<h>/
    - xform/('|^)<([a-z])>(ù|uán|ué|üé)(?=^|$|')/$1$2<i>/
    - xform/('|^)<([a-z])>(ái|ǒ|ū|u|ér|īng|ing|uǎi)(?=^|$|')/$1$2<j>/
    - xform/('|^)<([a-z])>(ē|e|íng|òu|ié)(?=^|$|')/$1$2<k>/
    - xform/('|^)<([a-z])>(ì|uī|ui)(?=^|$|')/$1$2<l>/
    - xform/('|^)<([a-z])>(ú|iāng|iang|ěng|ǔn)(?=^|$|')/$1$2<m>/
    - xform/('|^)<([a-z])>(í|iǎng|ǎn)(?=^|$|')/$1$2<n>/
    - xform/('|^)<([a-z])>(éng|iā|ia|ān|an|èr|uè|üè|iu|iū|uài|iáo)(?=^|$|')/$1$2<o>/
    - xform/('|^)<([a-z])>(uǒ|iè|iào|ěr|ǎng)(?=^|$|')/$1$2<p>/
    - xform/('|^)<([a-z])>(ēn|en|iǎn|ǒng|iáng|uá|ó|án|ǐng)(?=^|$|')/$1$2<q>/
    - xform/('|^)<([a-z])>(ìn|è|à|ě|ǎi|áo)(?=^|$|')/$1$2<r>/
    - xform/('|^)<([a-z])>(uō|uo|ǚ|uó|àn|ín|ūn|un|iōng|iong)(?=^|$|')/$1$2<s>/
    - xform/('|^)<([a-z])>(ō|o|iòng|ǎo|óu)(?=^|$|')/$1$2<t>/
    - xform/('|^)<([a-z])>(àng|iàn|ao|āo)(?=^|$|')/$1$2<u>/
    - xform/('|^)<([a-z])>(ǎ|uái|ōng|ong|īn|in|ióng|iǒng)(?=^|$|')/$1$2<v>/
    - xform/('|^)<([a-z])>(ào|èn|èng|iě|iàng)(?=^|$|')/$1$2<w>/
    - xform/('|^)<([a-z])>(uò|ōu|ou|iān|ian|ēi|ei|ùn)(?=^|$|')/$1$2<x>/
    - xform/('|^)<([a-z])>(én|ià|ang|āng|iú|ǐn|üē|uē|üe|ue)(?=^|$|')/$1$2<y>/
    - xform/('|^)<([a-z])>(uā|ua|òng|uǐ|áng|iǔ|iǎo)(?=^|$|')/$1$2<z>/
    - xform/'|<|>//
    # 兼容及收尾区
    # (应对中英混输中的无声调的轻声,待优化……无法解决中英混输中轻声的转换问题)
    - derive/le/dk/   # 中英文兼容,le⇋了
    - derive/ma/pe/   # 中英文兼容,ma⇋吗,嘛
    - derive/^.+$/\L$0/
    - erase/.*[^a-zA-Z].+$/